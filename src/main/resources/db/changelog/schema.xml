<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd"
        logicalFilePath="schema.xml">

    <changeSet id="create-user-table" author="mikael">
        <createTable tableName="users">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="username" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="password" type="varchar(80)">
                <constraints nullable="false"/>
            </column>
            <column name="firstname" type="varchar(30)">
                <constraints nullable="false"/>
            </column>
            <column name="lastname" type="varchar(30)">
                <constraints nullable="false"/>
            </column>
            <column name="email" type="varchar(60)">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="userrole" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>


    <changeSet id="addUniqueConstraint-user-table" author="mikael">
        <addUniqueConstraint columnNames="username" constraintName="uc_username" tableName="users"/>
        <addUniqueConstraint columnNames="email" constraintName="uc_email" tableName="users"/>
    </changeSet>

    <changeSet author="mikael" id="create-username-index">
        <createIndex indexName="idx_user_username" tableName="users" unique="true">
            <column name="username"/>
        </createIndex>
    </changeSet>

    <changeSet author="mikael" id="create-email-index">
        <createIndex indexName="idx_user_email" tableName="users" unique="true">
            <column name="email"/>
        </createIndex>
    </changeSet>

    <changeSet id="create-company-table" author="mikael">
        <createTable tableName="company">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(40)">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addUniqueConstraint-company-table" author="mikael">
        <addUniqueConstraint columnNames="name" constraintName="uc_company_name" tableName="company"/>
    </changeSet>

    <changeSet id="create-project-table" author="mikael">
        <createTable tableName="project">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_company" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="varchar(40)">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="provision" type="${boolean.type}">
                <constraints nullable="false"/>
            </column>
            <column name="internal" type="${boolean.type}" defaultValue="${boolean.type.false}">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addUniqueConstraint-project-table" author="mikael">
        <addUniqueConstraint columnNames="name" constraintName="uc_project_name" tableName="project"/>
    </changeSet>

    <changeSet id="addFK-project-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_company"
                                 baseTableName="project"
                                 constraintName="fk_project_company"
                                 referencedColumnNames="id"
                                 referencedTableName="company"/>
    </changeSet>

    <changeSet id="create-assignment-table" author="mikael">
        <createTable tableName="assignment">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_user" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="id_project" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-assignment-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_project"
                                 baseTableName="assignment"
                                 constraintName="fk_assignment_project"
                                 referencedColumnNames="id"
                                 referencedTableName="project"/>
        <addForeignKeyConstraint baseColumnNames="id_user"
                                 baseTableName="assignment"
                                 constraintName="fk_assignment_user"
                                 referencedColumnNames="id"
                                 referencedTableName="users"/>
    </changeSet>

    <changeSet author="mikael" id="create-assignment-user-proj-index">
        <createIndex indexName="idx_assignment_user_proj" tableName="assignment" unique="true">
            <column name="id_user"/>
            <column name="id_project"/>
        </createIndex>
    </changeSet>

    <changeSet id="create-time-table" author="mikael">
        <createTable tableName="timereport">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_assignment" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="reportedtime" type="DECIMAL(13,2)">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-timereport-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_assignment"
                                 baseTableName="timereport"
                                 constraintName="fk_time_assignment"
                                 referencedColumnNames="id"
                                 referencedTableName="assignment"/>
    </changeSet>

    <changeSet id="addUniqueConstraint-timereport-table" author="mikael">
        <addUniqueConstraint columnNames="id_assignment, date" constraintName="uc_assignment_date"
                             tableName="timereport"/>
    </changeSet>

    <changeSet id="create-public-holiday-table" author="mikael">
        <createTable tableName="publicholiday">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(40)">
                <constraints nullable="false"/>
            </column>
            <column name="workday" type="${boolean.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="create-systemproperty-table" author="mikael">
        <createTable tableName="systemproperty">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="varchar(100)"/>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addUniqueConstraint-systemproperty-table" author="mikael">
        <addUniqueConstraint columnNames="name" constraintName="uc_systemproperty_name" tableName="systemproperty"/>
    </changeSet>

    <changeSet id="create-time-close-table" author="mikael">
        <createTable tableName="closedate">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_user" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-closedate-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_user"
                                 baseTableName="closedate"
                                 constraintName="fk_closedate_user"
                                 referencedColumnNames="id"
                                 referencedTableName="users"/>
    </changeSet>

    <changeSet author="mikael" id="create-closedate-index">
        <createIndex indexName="idx_closedate" tableName="closedate" unique="true">
            <column name="id_user"/>
            <column name="date"/>
        </createIndex>
    </changeSet>

    <changeSet author="mikael" id="change-project-name-size">
        <modifyDataType columnName="name" newDataType="varchar(80)" tableName="project"/>
    </changeSet>

    <changeSet author="liquibase-docs" id="dropUniqueConstraint-example">
        <dropUniqueConstraint constraintName="uc_project_name" tableName="project"/>
    </changeSet>

    <changeSet id="addUniqueConstraint-project-table-1" author="mikael">
        <addUniqueConstraint columnNames="id_company, name" constraintName="uc_project_name" tableName="project"/>
    </changeSet>


    <changeSet id="addColumnCategoryToUserTabel" author="mikael">
        <addColumn tableName="users">
            <column name="category" type="varchar(20)"/>
        </addColumn>
    </changeSet>

    <changeSet id="addColumnSystemPropertyTabel" author="mikael">
        <addColumn tableName="systemproperty">
            <column name="type" type="varchar(20)"/>
            <column name="description" type="varchar(50)"/>
        </addColumn>
    </changeSet>

    <changeSet author="mikael" id="create-timereport-index">
        <createIndex indexName="idx_timereport" tableName="timereport" unique="true">
            <column name="id_assignment"/>
            <column name="date"/>
        </createIndex>
    </changeSet>

    <changeSet id="addColumnOnCallToProjectTabel" author="mikael">
        <addColumn tableName="project">
            <column name="oncall" type="${boolean.type}" defaultValue="${boolean.type.false}">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet author="mikael" id="create-timereport-date-index">
        <createIndex indexName="idx_timereport_date" tableName="timereport" unique="false">
            <column name="date"/>
        </createIndex>
    </changeSet>


    <changeSet id="create-oncall-table" author="mikael">
        <createTable tableName="oncall">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_assignment" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="type" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-oncall-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_assignment"
                                 baseTableName="oncall"
                                 constraintName="fk_oncall_assignment"
                                 referencedColumnNames="id"
                                 referencedTableName="assignment"/>
    </changeSet>

    <changeSet id="addUniqueConstraint-oncall-table" author="mikael">
        <addUniqueConstraint columnNames="id_assignment, date" constraintName="uc_oncall_assignment_date"
                             tableName="oncall"/>
    </changeSet>

    <changeSet id="dropNotNullConstraint-oncall-type" author="mikael">
        <dropNotNullConstraint columnName="type" tableName="oncall"/>
    </changeSet>

    <changeSet id="dropColumnTypeOnCallTable" author="mikael">
        <dropColumn columnName="type" tableName="oncall"/>
    </changeSet>

    <changeSet id="create-oncallconfig-table" author="mikael">
        <createTable tableName="oncallconfig">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_project" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="day" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="starttime" type="time"/>
            <column name="endtime" type="time"/>
            <column name="status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-oncallconfig-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_project"
                                 baseTableName="oncallconfig"
                                 constraintName="fk_oncallconfig_project"
                                 referencedColumnNames="id"
                                 referencedTableName="project"/>
    </changeSet>

    <changeSet id="addUniqueConstraint-oncallconfig-table" author="mikael">
        <addUniqueConstraint columnNames="id_project, day" constraintName="uc_oncallconfig_project_date"
                             tableName="oncallconfig"/>
    </changeSet>

    <changeSet id="addMobileNumberToUserTable" author="mikael">
        <addColumn tableName="users">
            <column name="mobilenumber" type="varchar(20)"/>
        </addColumn>
    </changeSet>

    <changeSet author="mikael" id="create-mobile-number-index">
        <createIndex indexName="idx_user_mobile" tableName="users" unique="true">
            <column name="mobilenumber"/>
        </createIndex>
    </changeSet>

    <changeSet id="create-oncallsession-table" author="mikael">
        <createTable tableName="oncallsession">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="datetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="create-oncallrule-table" author="mikael">
        <createTable tableName="oncallrule">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_project" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="fromemail" type="varchar(60)">
                <constraints nullable="false"/>
            </column>
            <column name="subjectcsv" type="varchar(100)"/>
            <column name="bodycsv" type="varchar(100)"/>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-oncallrule-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_project"
                                 baseTableName="oncallrule"
                                 constraintName="fk_oncallrule_project"
                                 referencedColumnNames="id"
                                 referencedTableName="project"/>
    </changeSet>

    <changeSet id="addColumnCategoryToProjectTabel" author="mikael">
        <addColumn tableName="project">
            <column name="category" type="varchar(20)" defaultValue="DEVELOPMENT">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>


    <changeSet id="changeDataTypesOfIdColumns" author="mikael">
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="users"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="users"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="users"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="company"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="company"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="company"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="project"/>
        <modifyDataType columnName="id_company" newDataType="${identifier.type}" tableName="project"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="project"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="project"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="assignment"/>
        <modifyDataType columnName="id_user" newDataType="${identifier.type}" tableName="assignment"/>
        <modifyDataType columnName="id_project" newDataType="${identifier.type}" tableName="assignment"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="assignment"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="assignment"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="timereport"/>
        <modifyDataType columnName="id_assignment" newDataType="${identifier.type}" tableName="timereport"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="timereport"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="timereport"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="publicholiday"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="publicholiday"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="publicholiday"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="systemproperty"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="systemproperty"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="systemproperty"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="closedate"/>
        <modifyDataType columnName="id_user" newDataType="${identifier.type}" tableName="closedate"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="closedate"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="closedate"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="oncall"/>
        <modifyDataType columnName="id_assignment" newDataType="${identifier.type}" tableName="oncall"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="oncall"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="oncall"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="oncallconfig"/>
        <modifyDataType columnName="id_project" newDataType="${identifier.type}" tableName="oncallconfig"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="oncallconfig"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="oncallconfig"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="oncallsession"/>
        <modifyDataType columnName="id" newDataType="${identifier.type}" tableName="oncallrule"/>
        <modifyDataType columnName="id_project" newDataType="${identifier.type}" tableName="oncallrule"/>
        <modifyDataType columnName="createdby" newDataType="${identifier.type}" tableName="oncallrule"/>
        <modifyDataType columnName="updatedby" newDataType="${identifier.type}" tableName="oncallrule"/>

    </changeSet>

    <changeSet id="add-columns-to-oncallsession-table" author="mikael">
        <addColumn tableName="oncallsession">
            <column name="totalemails" type="bigint" defaultValue="0"/>
            <column name="totaldispatched" type="bigint" defaultValue="0"/>
            <column name="readinlastpoll" type="integer" defaultValue="0"/>
            <column name="dispatchedinlastpoll" type="integer" defaultValue="0"/>
            <column name="mailininboxinlastpoll" type="integer" defaultValue="0"/>
            <column name="message" type="varchar(250)"/>
        </addColumn>
    </changeSet>

    <changeSet id="create-oncallalarm-table" author="mikael">
        <createTable tableName="oncallalarm">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_project" type="${identifier.type}">
                <constraints nullable="true"/>
            </column>
            <column name="id_user" type="${identifier.type}">
                <constraints nullable="true"/>
            </column>
            <column name="sender" type="varchar(100)"/>
            <column name="subject" type="varchar(100)"/>
            <column name="emailsent" type="${boolean.type}" defaultValue="${boolean.type.false}"/>
            <column name="instantmsgsent" type="${boolean.type}" defaultValue="${boolean.type.false}"/>
            <column name="status" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="severity" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="message" type="varchar(250)"/>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="create-activity-table" author="mikael">
        <createTable tableName="activity">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="description" type="varchar(100)">
                <constraints nullable="false"/>
            </column>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="create-activity-user-table" author="mikael">
        <createTable tableName="activityuser">
            <column name="id_activity" type="${identifier.type}"/>
            <column name="id_user" type="${identifier.type}"/>
        </createTable>
    </changeSet>


    <changeSet id="addFK-activity-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_activity"
                                 baseTableName="activityuser"
                                 constraintName="fk_activityuser_activity"
                                 referencedColumnNames="id"
                                 referencedTableName="activity"/>
        <addForeignKeyConstraint baseColumnNames="id_user"
                                 baseTableName="activityuser"
                                 constraintName="fk_activityuser_user"
                                 referencedColumnNames="id"
                                 referencedTableName="users"/>
    </changeSet>

    <changeSet id="addUniqueConstraint-activity-table" author="mikael">
        <addUniqueConstraint columnNames="id_activity, id_user" constraintName="uc_activityuser"
                             tableName="activityuser"/>
    </changeSet>

    <changeSet id="create-rate-table" author="mikael">
        <createTable tableName="rate">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_assignment" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="fromdate" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="todate" type="date"/>
            <column name="ratecustomer" type="DECIMAL(13,2)">
                <constraints nullable="false"/>
            </column>
            <column name="ratesubcontractor" type="DECIMAL(13,2)"/>
            <column name="hourrate" type="${boolean.type}" defaultValue="${boolean.type.true}"/>
            <column name="comment" type="varchar(250)"/>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-rate-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_assignment"
                                 baseTableName="rate"
                                 constraintName="fk_rate_assignment"
                                 referencedColumnNames="id"
                                 referencedTableName="assignment"/>
    </changeSet>

    <changeSet id="dropColumnHourRateOnRateTable" author="mikael">
        <dropColumn columnName="hourrate" tableName="rate"/>
    </changeSet>

    <changeSet id="create-fixrate-table" author="mikael">
        <createTable tableName="fixrate">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_project" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="fromdate" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="todate" type="date"/>
            <column name="ratecustomer" type="DECIMAL(13,2)">
                <constraints nullable="false"/>
            </column>
            <column name="comment" type="varchar(250)"/>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-fixrate-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_project"
                                 baseTableName="fixrate"
                                 constraintName="fk_fixrate_proj"
                                 referencedColumnNames="id"
                                 referencedTableName="project"/>
    </changeSet>

    <changeSet id="addColumnFixRateToProjectTabel" author="mikael">
        <addColumn tableName="project">
            <column name="fixrate" type="${boolean.type}" defaultValue="${boolean.type.false}">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="create-montlychecks-table" author="mikael">
        <createTable tableName="monthlycheck">
            <column name="id" type="${identifier.type}">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="id_company" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="invoiceverified" type="${boolean.type}" defaultValue="${boolean.type.false}"/>
            <column name="invoicesent" type="${boolean.type}" defaultValue="${boolean.type.false}"/>
            <column name="createdatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedatetime" type="${timestamp.type}">
                <constraints nullable="false"/>
            </column>
            <column name="createdby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
            <column name="updatedby" type="${identifier.type}">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="addFK-monthlycheck-table" author="mikael">
        <addForeignKeyConstraint baseColumnNames="id_company"
                                 baseTableName="monthlycheck"
                                 constraintName="fk_monthlycheck_comp"
                                 referencedColumnNames="id"
                                 referencedTableName="company"/>
    </changeSet>

    <changeSet author="mikael" id="create-monthlycheck-index">
        <createIndex indexName="idx_monthlycheck" tableName="monthlycheck" unique="true">
            <column name="id_company"/>
            <column name="date"/>
        </createIndex>
    </changeSet>

</databaseChangeLog>